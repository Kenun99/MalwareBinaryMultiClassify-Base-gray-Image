"""
预测单个样本实例
"""
from keras.models import load_model
import numpy as np
import pandas as pd


def predict(vec_filem ,model):
    test_features = pd.read_csv(vec_file)
    test_features.drop("Id", axis=1, inplace=True)
    test_features = test_features.values
    sample_pred = model.predict(test_features)
    sample_pred = np.argmax(sample_pred.squeeze())
    print("prediction: ", sample_pred)
    malware_class = ["Ramnit", "Lollipop", "Kelihos_ver3", "Vundo", "Simda",
                     "Tracur", "Kelihos_ver1", "Obfuscator.ACY", "Gatak"]
    print("Class should be: ", malware_class[sample_pred])


def main():
    '''
    example04EjIdbPV5e1XroFOpiN_label=1.csv    label = 1    prediction should be 0
    example8nOj13Lz5askQDpbwxy2_label=2.csv    label = 2    prediction should be 1
    exampleH24gZfhreXtDJMjo1ISx_label=7.csv    label = 7    prediction should be 6
    '''
    vec_file = "./dataset/exampleH24gZfhreXtDJMjo1ISx_label=7.csv"  # vector file
    # class from 0 to 8
    model = load_model('Bpnn_features10000_model_batchSize512')
    predict(vec_file, model)


main()
